### –ü–æ—Ç–æ–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É—Å–ø–µ—à–Ω—ã—Ö –∏ –Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## 1. **–ó–∞–ø—Ä–æ—Å –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é**

### –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å:
1. **–ö–ª–∏–µ–Ω—Ç:**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/auth/login`) —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
     ```http
     POST /auth/login HTTP/1.1
     Content-Type: application/json
     {
       "username": "user",
       "password": "password"
     }
     ```

2. **DispatcherServlet:**
   - –ù–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ —Ü–µ–ø–æ—á–∫—É —Ñ–∏–ª—å—Ç—Ä–æ–≤.

3. **Spring Security Filter Chain:**
   - `UsernamePasswordAuthenticationFilter`:
     - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
     - –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–Ω—ã, —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç `Authentication` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –≤ `SecurityContext`.
   - –¢–æ–∫–µ–Ω JWT –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É.

4. **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–∫–µ–Ω –∫–ª–∏–µ–Ω—Ç—É:
     ```json
     {
       "token": "<jwt_token>"
     }
     ```

---

### –ù–µ—É—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å:
1. **–ö–ª–∏–µ–Ω—Ç:**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å —Å –Ω–µ–≤–µ—Ä–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

2. **DispatcherServlet:**
   - –ù–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ —Ü–µ–ø–æ—á–∫—É —Ñ–∏–ª—å—Ç—Ä–æ–≤.

3. **Spring Security Filter Chain:**
   - `UsernamePasswordAuthenticationFilter`:
     - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
     - –ï—Å–ª–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç `BadCredentialsException`.

4. **ExceptionHandlerAdvice:**
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç:
     ```json
     {
       "flag": false,
       "code": 401,
       "message": "username or password is incorrect."
     }
     ```

---

## 2. **–ó–∞–ø—Ä–æ—Å –Ω–∞ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç**

---

### –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å (—Å —Ç–æ–∫–µ–Ω–æ–º):
1. **–ö–ª–∏–µ–Ω—Ç:**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å —Å —Ç–æ–∫–µ–Ω–æ–º:
     ```http
     GET /users/123 HTTP/1.1
     Authorization: Bearer <valid_token>
     ```

2. **DispatcherServlet:**
   - –ù–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ —Ü–µ–ø–æ—á–∫—É —Ñ–∏–ª—å—Ç—Ä–æ–≤.

3. **Spring Security Filter Chain:**
   - `BearerTokenAuthenticationFilter`:
     - –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–æ–∫–µ–Ω –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞.
     - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞.
     - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±—ä–µ–∫—Ç `Authentication` –≤ `SecurityContext`.

4. **JwtInterceptor:**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —Ç–æ–∫–µ–Ω –≤ –±–µ–ª–æ–º —Å–ø–∏—Å–∫–µ Redis.

5. **UserRequestAuthorizationManager:**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
     - –ï—Å–ª–∏ `ROLE_admin` –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å—É (`userId` —Å–æ–≤–ø–∞–¥–∞–µ—Ç), –∑–∞–ø—Ä–æ—Å –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É.

6. **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä:**
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ:
     ```json
     {
       "flag": true,
       "code": 200,
       "message": "Success",
       "data": { "id": 123, "name": "John Doe" }
     }
     ```

---

### –ù–µ—É—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å (—Å –Ω–µ–≤–µ—Ä–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º):
1. **–ö–ª–∏–µ–Ω—Ç:**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å —Å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º.

2. **Spring Security Filter Chain:**
   - `BearerTokenAuthenticationFilter`:
     - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω.
     - –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É `401 Unauthorized` —á–µ—Ä–µ–∑ `CustomBearerTokenAuthenticationEntryPoint`.

3. **ExceptionHandlerAdvice:**
   - –§–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç:
     ```json
     {
       "flag": false,
       "code": 401,
       "message": "The access token provided is expired, revoked, malformed, or invalid for other reasons."
     }
     ```

---

### –ù–µ—É—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞):
1. **–ö–ª–∏–µ–Ω—Ç:**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Authorization`.

2. **Spring Security Filter Chain:**
   - `BearerTokenAuthenticationFilter`:
     - –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫–µ–Ω–∞.
     - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É `401 Unauthorized` —á–µ—Ä–µ–∑ `CustomBearerTokenAuthenticationEntryPoint`.

3. **ExceptionHandlerAdvice:**
   - –§–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç:
     ```json
     {
       "flag": false,
       "code": 401,
       "message": "Login credentials are missing."
     }
     ```

---

## 3. **–ó–∞–ø—Ä–æ—Å –Ω–∞ –Ω–µ–∑–∞—â–∏—â–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç**

---

### –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å:
1. **–ö–ª–∏–µ–Ω—Ç:**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å:
     ```http
     GET /artifacts/123 HTTP/1.1
     ```

2. **DispatcherServlet:**
   - –ù–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ —Ü–µ–ø–æ—á–∫—É —Ñ–∏–ª—å—Ç—Ä–æ–≤.

3. **Spring Security Filter Chain:**
   - –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∑–∞–ø—Ä–æ—Å, —Ç–∞–∫ –∫–∞–∫ –º–∞—Ä—à—Ä—É—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
     ```java
     .requestMatchers("/artifacts/**").permitAll()
     ```

4. **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä:**
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ:
     ```json
     {
       "flag": true,
       "code": 200,
       "message": "Artifact retrieved successfully.",
       "data": { "id": 123, "name": "Artifact A" }
     }
     ```

---

### –ù–µ—É—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–æ—à–∏–±–∫–∞ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ):
1. **–ö–ª–∏–µ–Ω—Ç:**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å, –Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä `ObjectNotFoundException`.

2. **ExceptionHandlerAdvice:**
   - –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç:
     ```json
     {
       "flag": false,
       "code": 404,
       "message": "This API endpoint is not found."
     }
     ```

---

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤

| **–¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞**            | **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**                                                                                     | **–¢–∏–ø –æ—Ç–≤–µ—Ç–∞**                                                                 |
|-----------------------------|---------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
| –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è                | `UsernamePasswordAuthenticationFilter`, `Controller`, `ExceptionHandlerAdvice`                   | –£—Å–ø–µ—Ö: —Ç–æ–∫–µ–Ω; –û—à–∏–±–∫–∞: `401 Unauthorized`                                       |
| –ó–∞—â–∏—â–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç        | `BearerTokenAuthenticationFilter`, `JwtInterceptor`, `UserRequestAuthorizationManager`, `Controller`, `ExceptionHandlerAdvice` | –£—Å–ø–µ—Ö: –¥–∞–Ω–Ω—ã–µ; –û—à–∏–±–∫–∞: `401 Unauthorized` –∏–ª–∏ `403 Forbidden`                 |
| –ù–µ–∑–∞—â–∏—â–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç      | `Spring Security Filter Chain` (–±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏), `Controller`, `ExceptionHandlerAdvice`           | –£—Å–ø–µ—Ö: –¥–∞–Ω–Ω—ã–µ; –û—à–∏–±–∫–∞: `404 Not Found` (–µ—Å–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å) |

---

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã —É—Ç–æ—á–Ω–µ–Ω–∏—è –∏–ª–∏ —Å—Ö–µ–º—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üòä